The test was forcing failure at the end withoug checking the actual result.
By removing lines 14 and 15 in test.S the test executes and passes correctly.